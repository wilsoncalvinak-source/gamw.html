<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TERMINAL 9 // ERROR_IN_REALITY</title>
    <style>
        :root { --p-green: #00ff41; --p-red: #ff0000; --bg: #000; }
        body { background: var(--bg); color: var(--p-green); font-family: 'Courier New', monospace; margin: 0; overflow: hidden; height: 100vh; }
        
        #game-window { max-width: 900px; margin: auto; height: 100vh; display: flex; flex-direction: column; padding: 20px; position: relative; z-index: 5; }
        #output { flex: 1; overflow-y: auto; padding: 20px 0; font-size: 1.1rem; line-height: 1.6; }
        .input-area { display: flex; border-top: 1px solid #1a1a1a; padding: 20px 0; }
        input { background: transparent; border: none; color: var(--p-green); font-family: inherit; font-size: 1.2rem; flex: 1; outline: none; }

        /* JUMPSCARE OVERLAY */
        #jumpscare { 
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; 
            background: #000; display: none; z-index: 100; 
            justify-content: center; align-items: center;
        }
        #jumpscare img { width: 100%; height: 100%; object-fit: cover; filter: contrast(150%) brightness(80%); }

        /* SCARY EFFECTS */
        .glitch { color: var(--p-red); animation: shake 0.1s infinite; font-weight: bold; }
        @keyframes shake {
            0% { transform: translate(1px, 1px); }
            50% { transform: translate(-2px, -1px); filter: blur(1px); }
            100% { transform: translate(1px, -2px); }
        }
        
        canvas { position: fixed; top: 0; left: 0; opacity: 0.15; pointer-events: none; }
        .stat-line { border-bottom: 1px solid #222; padding-bottom: 5px; margin-bottom: 10px; display: flex; justify-content: space-between; }
    </style>
</head>
<body>
    <div id="jumpscare">
        <img src="jumpscare.jpg" alt="THEY FOUND YOU">
    </div>
    <canvas id="staticCanvas"></canvas>

    <div id="game-window">
        <div class="stat-line">
            <span>SECTOR: <span id="loc">1</span>/50</span>
            <span>THREAT: <span id="threat">LOW</span></span>
        </div>
        <div id="output"></div>
        <div class="input-area">
            <span>>&nbsp;</span><input type="text" id="userInput" autofocus autocomplete="off">
        </div>
    </div>

<script>
const game = {
    currentSector: 1,
    stalkerSector: 10, // Stalker starts ahead of you or behind
    isAlive: true,
    moveCount: 0,
    
    // 50 unique room descriptions
    getRoomDesc(num) {
        const descs = [
            "The air is metallic. Scratches line the door frame.",
            "Old blood has turned black on the ceiling tiles.",
            "A wet, rhythmic slapping sound comes from the vents.",
            "The lights are dead. Your flashlight reveals a tooth on the floor.",
            "Something is breathing in the corner. Do not look at it.",
            "The walls are covered in mathematical equations written in ash.",
            "A smell of rotting meat fills the small corridor.",
            "You find a discarded radio. It only plays static and screaming."
        ];
        return descs[num % descs.length];
    },

    init() {
        this.log("CONNECTION ESTABLISHED. PROCEED TO SECTOR 50 FOR EVACUATION.", "meta");
        this.log("Type 'north' to move forward, 'south' to retreat, 'hide' to wait.");
        this.updateRoom();
        this.drawStatic();
    },

    log(msg, type = "") {
        const out = document.getElementById('output');
        const p = document.createElement('p');
        p.innerHTML = msg;
        if(type) p.className = type;
        out.appendChild(p);
        out.scrollTop = out.scrollHeight;
    },

    // SUPER SCARY NOISE ENGINE
    playScaryNoise() {
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        const oscillator = audioCtx.createOscillator();
        const gainNode = audioCtx.createGain();

        oscillator.type = 'sawtooth';
        oscillator.frequency.setValueAtTime(50, audioCtx.currentTime);
        oscillator.frequency.exponentialRampToValueAtTime(2000, audioCtx.currentTime + 0.1);
        oscillator.frequency.exponentialRampToValueAtTime(40, audioCtx.currentTime + 0.8);

        gainNode.gain.setValueAtTime(1, audioCtx.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 1);

        oscillator.connect(gainNode);
        gainNode.connect(audioCtx.destination);

        oscillator.start();
        oscillator.stop(audioCtx.currentTime + 1);
    },

    triggerJumpscare() {
        this.isAlive = false;
        document.getElementById('jumpscare').style.display = 'flex';
        this.playScaryNoise();
        
        setTimeout(() => {
            document.body.innerHTML = "<div style='color:red; font-size:3rem; text-align:center; padding-top:40vh; background:black; height:100vh;'>SYSTEM_FAILURE: USER_TERMINATED</div>";
        }, 1500);
    },

    moveStalker() {
        // The stalker slowly hunts the player
        if (this.stalkerSector < this.currentSector) this.stalkerSector++;
        else if (this.stalkerSector > this.currentSector) this.stalkerSector--;

        // If you cross paths or it finds you
        if (this.stalkerSector === this.currentSector) {
            this.triggerJumpscare();
        }
    },

    process(input) {
        if (!this.isAlive) return;
        const cmd = input.toLowerCase().trim();
        
        if (cmd === 'north' || cmd === 'n') {
            this.currentSector++;
            this.log("You move deeper into the dark...");
        } else if (cmd === 'south' || cmd === 's') {
            if (this.currentSector > 1) this.currentSector--;
            this.log("You retreat, heart pounding.");
        } else if (cmd === 'hide') {
            this.log("You hide in the shadows. You hear it pass by the door...");
            // Hiding stops the stalker from moving this turn
            return; 
        } else {
            this.log("You fumble with the controls. You are wasting time.");
        }

        this.moveCount++;
        this.moveStalker();
        this.updateRoom();
    },

    updateRoom() {
        const dist = Math.abs(this.currentSector - this.stalkerSector);
        const threatSpan = document.getElementById('threat');
        
        document.getElementById('loc').innerText = this.currentSector;
        
        if (dist <= 1) {
            threatSpan.innerText = "EXTREME";
            threatSpan.className = "glitch";
            this.log("THEY ARE RIGHT BEHIND YOU.", "glitch");
        } else if (dist <= 3) {
            threatSpan.innerText = "HIGH";
            threatSpan.style.color = "red";
            this.log("You hear heavy breathing in the distance.");
        } else {
            threatSpan.innerText = "LOW";
            threatSpan.style.color = "var(--p-green)";
        }

        this.log(`<br><b>SECTOR ${this.currentSector}</b>`);
        this.log(this.getRoomDesc(this.currentSector));

        if (this.currentSector >= 50) {
            this.log("THE ESCAPE POD IS HERE. YOU MADE IT OUT.", "meta");
            this.isAlive = false;
        }
    },

    drawStatic() {
        const canvas = document.getElementById('staticCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        setInterval(() => {
            const idata = ctx.createImageData(canvas.width, canvas.height);
            for (let i = 0; i < idata.data.length; i += 4) {
                const v = Math.random() * 255;
                idata.data[i] = idata.data[i+1] = idata.data[i+2] = v;
                idata.data[i+3] = 255;
            }
            ctx.putImageData(idata, 0, 0);
        }, 50);
    }
};

document.getElementById('userInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        game.process(e.target.value);
        e.target.value = '';
    }
});

game.init();
</script>
</body>
</html>
