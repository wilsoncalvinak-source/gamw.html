<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TERMINAL 9 // VOID_SEARCH</title>
    <style>
        :root { --p-green: #00ff41; --p-red: #aa0000; --bg: #000; }
        body { background: var(--bg); color: var(--p-green); font-family: 'Courier New', monospace; margin: 0; overflow: hidden; height: 100vh; }
        
        #game-window { max-width: 900px; margin: auto; height: 100vh; display: flex; flex-direction: column; padding: 20px; position: relative; }
        #output { flex: 1; overflow-y: auto; padding: 20px 0; font-size: 1.1rem; line-height: 1.6; }
        .input-area { display: flex; border-top: 1px solid #1a1a1a; padding: 20px 0; }
        input { background: transparent; border: none; color: var(--p-green); font-family: inherit; font-size: 1.2rem; flex: 1; outline: none; }

        /* JUMPSCARE OVERLAY (No Flashing) */
        #jumpscare-overlay { 
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; 
            background: #000; display: none; z-index: 100; 
            justify-content: center; align-items: center;
        }
        #jumpscare-img { width: 100%; height: 100%; object-fit: contain; transition: transform 0.05s; }

        /* VIGNETTE */
        #vignette { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle, transparent 20%, #000 100%); pointer-events: none; z-index: 90; }
        
        canvas { position: fixed; top: 0; left: 0; opacity: 0.1; pointer-events: none; }
        .scramble { color: var(--p-red); font-weight: bold; }
    </style>
</head>
<body>
    <div id="jumpscare-overlay"><img id="jumpscare-img" src="jumpscare.jpg"></div>
    <div id="vignette"></div>
    <canvas id="staticCanvas"></canvas>

    <div id="game-window">
        <div style="display:flex; justify-content:space-between; border-bottom: 1px solid #222;">
            <span>FACILITY COORD: [<span id="coord-x">0</span>, <span id="coord-y">0</span>]</span>
            <span id="threat-level">UPLINK: STABLE</span>
        </div>
        <div id="output"></div>
        <div class="input-area">
            <span>>&nbsp;</span><input type="text" id="userInput" autofocus autocomplete="off" placeholder="type north, south, east, west...">
        </div>
    </div>

    <audio id="scaryAudio" src="jumpscare-68730.mp3" preload="auto"></audio>

<script>
const game = {
    x: 0, y: 0,
    ex: 6, ey: 6, // Enemy starting distance
    isAlive: true,

    init() {
        this.log("BIO-TERMINAL INITIALIZED. THE ENTITY IS ACTIVE.");
        this.log("WARNING! IF YOU ARE A WUSS AND YOU EASILY GET SCARED THIS IS NOT A JOKE. DO NOT PLAY THIS.");
        this.updateRoom();
        this.drawStatic();
    },

    log(msg, type = "") {
        const out = document.getElementById('output');
        const p = document.createElement('p');
        p.innerHTML = msg;
        if(type) p.className = type;
        out.appendChild(p);
        out.scrollTop = out.scrollHeight;
    },

    triggerDeath() {
        if(!this.isAlive) return;
        this.isAlive = false;

        const overlay = document.getElementById('jumpscare-overlay');
        const img = document.getElementById('jumpscare-img');
        const audio = document.getElementById('scaryAudio');

        overlay.style.display = 'flex';
        audio.play().catch(e => console.log("Audio requires user interaction first."));

        // Intense jitter/shake effect (Debilitating but non-flashing)
        const shake = setInterval(() => {
            const rX = (Math.random() - 0.5) * 40;
            const rY = (Math.random() - 0.5) * 40;
            img.style.transform = `translate(${rX}px, ${rY}px) scale(1.2)`;
        }, 30);

        setTimeout(() => {
            clearInterval(shake);
            document.body.innerHTML = "<div style='background:black; color:red; height:100vh; display:flex; align-items:center; justify-content:center; font-family:serif; text-align:center;'><h1>USER CONSUMED.<br>UPLINK DISCONNECTED.</h1></div>";
        }, 4000);
    },

    process(input) {
        if (!this.isAlive) return;
        const cmd = input.toLowerCase().trim();
        
        if (cmd === 'north' || cmd === 'n') this.y++;
        else if (cmd === 'south' || cmd === 's') this.y--;
        else if (cmd === 'east' || cmd === 'e') this.x++;
        else if (cmd === 'west' || cmd === 'w') this.x--;
        else if (cmd === 'hide') this.log("You stop breathing. The walls feel thin.");
        else {
            this.log("UNKNOWN INPUT. PANIC DETECTED.");
            return;
        }

        // Advanced AI: Calculated pathing toward player
        if (this.ex < this.x) this.ex++;
        else if (this.ex > this.x) this.ex--;
        
        if (this.ey < this.y) this.ey++;
        else if (this.ey > this.y) this.ey--;

        this.checkProximity();
    },

    checkProximity() {
        const dist = Math.abs(this.x - this.ex) + Math.abs(this.y - this.ey);
        const threat = document.getElementById('threat-level');

        if (dist === 0) {
            this.triggerDeath();
        } else if (dist <= 2) {
            threat.innerText = "UPLINK: CORRUPTED";
            threat.style.color = "red";
            this.log(this.scramble("IT IS RIGHT BEHIND YOU."), "scramble");
            // Heavy UI Blur for safe "glitch" effect
            document.getElementById('game-window').style.filter = "blur(2px) contrast(150%)";
        } else {
            threat.innerText = "UPLINK: STABLE";
            threat.style.color = "var(--p-green)";
            document.getElementById('game-window').style.filter = "none";
            this.updateRoom();
        }
    },

    updateRoom() {
        document.getElementById('coord-x').innerText = this.x;
        document.getElementById('coord-y').innerText = this.y;
        this.log(`<br><b>[SECTOR ${this.x}:${this.y}]</b>`);
        
        const vibes = [
            "The darkness here feels heavy.",
            "You hear the sound of bone scraping on metal.",
            "The silence is broken by a wet, clicking sound.",
            "Something just moved in your peripheral vision."
        ];
        this.log(vibes[Math.abs(this.x + this.y) % vibes.length]);
    },

    scramble(text) {
        return text.split('').map(char => Math.random() > 0.7 ? "â–ˆ" : char).join('');
    },

    drawStatic() {
        const canvas = document.getElementById('staticCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        setInterval(() => {
            const idata = ctx.createImageData(canvas.width, canvas.height);
            for (let i = 0; i < idata.data.length; i += 4) {
                const v = Math.random() * 255;
                idata.data[i] = idata.data[i+1] = idata.data[i+2] = v;
                idata.data[i+3] = 255;
            }
            ctx.putImageData(idata, 0, 0);
        }, 150);
    }
};

document.getElementById('userInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        game.process(e.target.value);
        e.target.value = '';
    }
});

game.init();
</script>
</body>
</html>
